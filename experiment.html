<!doctype html>
<html>
	<head>
		<title>JS1k, [COMPO] demo submission [ID]</title>
		<meta charset="utf-8" />
    <style>
      html, body { margin: 0; padding: 0; border: 0; }
      #c { display: block; } /* kill scrollbars from hell */
    </style>
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var a = document.getElementsByTagName('canvas')[0];
			var b = document.body;
      var d = function(e){ return function(){ e.parentNode.removeChild(e); }; }(a);
      // unprefix some popular vendor prefixed things (but stick to their original name)
      var AudioContext =
        window.AudioContext ||
        window.webkitAudioContext;
      var requestAnimationFrame =
        window.requestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(f){ setTimeout(f, 1000/30); };
      // stretch canvas to screen size (once, wont onresize!)
      a.style.width = (a.width = innerWidth) + 'px';
      a.style.height = (a.height = innerHeight) + 'px';

      var c = a.getContext('2d');
		</script>
		<script>
// start of submission //
var nbCellsL = 50;
var nbCellsH = 50;
var cells = cellsTemp = [];

function run() {

	// Draw:
	var s = '';
	for( var j=1; j<(nbCellsH-1); j++ ) {
		for( var i=1; i<(nbCellsL-1); i++ ) {
			s+= cells[nbCellsL*j+i];
		}
		s+='<br/>';
		b.innerHTML = s;
	}
	
	// Iterate:
    cellsTemp = cells;

    for( var j=1; j<(nbCellsH-1); j++ )
		for( var i=1; i<(nbCellsL-1); i++ ) {
			var off = nbCellsL*j+i;

			var k = cellsTemp[ off-nbCellsL+1 ] + cellsTemp[ off-nbCellsL+0 ] +	cellsTemp[ off-nbCellsL-1 ] +
						  cellsTemp[ off  +1 ] +                     				 	cellsTemp[ off  -1 ] +
						  cellsTemp[ off+nbCellsL+1 ] + cellsTemp[ off+nbCellsL+0 ] + 	cellsTemp[ off+nbCellsL-1 ];

			cells[off] = ((cellsTemp[off] && (k==3 || k==2)) || (!cellsTemp[off] && (k==3)))?1:0;
		}
	
	// Keep on:
	requestAnimationFrame(run);
}

// Init
for( var j=10; j<(nbCellsH-10); j++ )
	for( var i=10; i<(nbCellsL-10); i++ ) {
		cells[nbCellsL*j+i] = Math.random()+.5|0;
	}

// Run
run();
	
// end of submission //
		</script>
	</body>
</html>
